<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Perfil - Imune Life</title>
    <link rel="shortcut icon" href="img/logoo.png" type="image/x-icon">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css" integrity="sha512-DTOQO9RWCH3ppGqcWaEA1BIZOC6xxalwEsw9c2QQeAIftl+Vegovlnee1c9QX4TctnWMn13TZye+giMm8e2LwA==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link rel="stylesheet" href="../style.css">
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet" />

    <style>
        body {
            font-family: "Inter", sans-serif;
            background: radial-gradient(circle at center, #4a90e2 0%, #20579e 100%);
            min-height: 100vh;
            overflow-y: auto;
            overflow-x: hidden;
        }


        .glass {
            background-color: rgba(255, 255, 255, 0.15);
            backdrop-filter: blur(8px);
            border: 1px solid rgba(255, 255, 255, 0.2);
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2),
                0 0 50px rgba(255, 255, 255, 0.05) inset;
        }

        .floating-shape {
            position: absolute;
            opacity: 0.12;
            filter: blur(1px);
            color: #8ac0ff;
            z-index: 0;
        }
        .shape1 { top: 10%; left: 15%; transform: scale(1.3); }
        .shape2 { top: 40%; right: 8%; transform: scale(1.1); }
        .shape3 { bottom: 10%; left: 10%; transform: scale(0.9); }
        .shape4 { bottom: 5%; right: 25%; transform: scale(1.7); }
    </style>
</head>

<body class="flex items-start justify-center p-6">

    <!-- Shapes do fundo -->
    <div class="floating-shape shape1">
        <svg width="60" height="60" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2L2 7v10l10 5l10-5V7z"/></svg>
    </div>
    <div class="floating-shape shape2">
        <svg width="50" height="50" viewBox="0 0 24 24"><path fill="currentColor" d="M11 3h2v18h-2z"/></svg>
    </div>
    <div class="floating-shape shape3">
        <svg width="50" height="50" viewBox="0 0 24 24"><path fill="currentColor" d="M12 21.3C6.5 15.7 4 12 4 9a8 8 0 0 1 16 0c0 3-2.5 6.7-8 12.3"/></svg>
    </div>
    <div class="floating-shape shape4">
        <svg width="70" height="70" viewBox="0 0 24 24"><path fill="currentColor" d="M12 2a7 7 0 1 1 0 14a7 7 0 0 1 0-14"/></svg>
    </div>

    <!-- SIDEBAR -->
    <nav id="sidebar">
        <div id="sidebar_content">
            
            <div id="sidebar_logo">
                <img src="../img/logoo.png" alt="Logo Imune Life">
            </div>

            <ul id="side_items">
                <li class="side-item">
                    <a href="/src/login.html">
                        <i class="fa-solid fa-user"></i>
                        <span class="item-description">
                            Nome completo
                        </span>
                    </a>
                </li>
                
                <li class="side-item">
                    <a href="/src/perfil.html">
                        <i class="fa-solid fa-trophy"></i>
                        <span class="item-description">
                            Pontuação
                        </span>
                    </a>
                </li>

                <li class="side-item">
                    <a href="/index.html">
                        <i class="fa-solid fa-house"></i>
                        <span class="item-description">
                            Página Inicial
                        </span>
                    </a>
                </li>

                <li class="side-item">
                    <a href="/index.html#map-section">
                        <i class="fa-solid fa-map-location-dot"></i>
                        <span class="item-description">
                            Buscar perto de mim
                        </span>
                    </a>
                </li>
            </ul>
        </div>

        <div id="sidebar_footer">
            <a href="#" id="about_btn">
                <i class="fa-solid fa-circle-info"></i>
                <span class="item-description">
                    Sobre
                </span>
            </a>
        </div>
    </nav>

    <!-- CONTEÚDO -->
    <main class="glass w-[85%] ml-32 p-10 rounded-3xl text-white relative z-10">

        <!-- Cabeçalho do perfil -->
        <div class="flex items-start justify-between">

            <!-- Foto + Dados -->
            <div class="flex items-center space-x-6">
                <div class="w-28 h-28 rounded-full bg-white/20 flex items-center justify-center shadow-xl">
                    <svg width="80" height="80" viewBox="0 0 24 24" fill="none" stroke="white" stroke-width="1.5">
                        <circle cx="12" cy="7" r="4"></circle>
                        <path d="M6 21v-2a4 4 0 0 1 4-4h4a4 4 0 0 1 4 4v2"></path>
                    </svg>
                </div>

                <div class="text-sm space-y-1">
                    <p><strong>Nome Completo:</strong> Maria Santos</p>
                    <p><strong>E-mail:</strong> maria@email.com</p>
                    <p><strong>Data de Nascimento:</strong> 12/06/2007</p>
                </div>

                <div class="text-sm space-y-1 ml-20">
                    <p><strong>CNS:</strong> 000 0000 0000 0000</p>
                    <p><strong>RG:</strong> 00.000.000-0</p>
                    <p><strong>CPF:</strong> 000.000.000-00</p>
                </div>

            </div>
        </div>

        <!-- Barra de Progresso -->
        <div class="mt-6">
            <p class="mb-1 text-sm">Nível de Progresso</p>
            <div class="w-full bg-white/40 rounded-full h-4">
                <div class="bg-teal-400 h-4 rounded-full" style="width: 45%;"></div>
            </div>
        </div>

        <!-- XP + Tabela -->
        <div class="mt-10 grid grid-cols-2 gap-10" >

            <!-- Sistema de XP -->
            <div class="glass p-6 rounded-2xl" id="pontuacao">
                <h2 class="font-semibold text-lg mb-4">Recompensas XP</h2>

                <div class="space-y-4 text-sm">

                    <div class="flex items-center space-x-3">
                        <img src="https://cdn-icons-png.flaticon.com/512/2583/2583297.png" class="w-10" />
                        <p><strong>10xp</strong> = 5% de desconto <a href="#" class="underline text-blue-200">mais</a></p>
                    </div>

                    <div class="flex items-center space-x-3">
                        <img src="https://cdn-icons-png.flaticon.com/512/2583/2583313.png" class="w-10" />
                        <p><strong>5xp</strong> = 2% de desconto <a href="#" class="underline text-blue-200">mais</a></p>
                    </div>

                    <div class="flex items-center space-x-3">
                        <img src="https://cdn-icons-png.flaticon.com/512/2583/2583331.png" class="w-10" />
                        <p><strong>2xp</strong> = continue assim, tá quase lá</p>
                    </div>

                </div>
            </div>

            <!-- Tabela Vacinas -->
            <div class="glass p-6 rounded-2xl">
                <h2 class="font-semibold text-lg mb-4">Histórico de Vacinas</h2>

                <button class="bg-teal-400 px-4 py-2 rounded-xl text-sm font-semibold mb-4 hover:bg-teal-500">
                    Adicionar Vacina
                </button>

                <table class="w-full text-sm">
                    
                    <thead>
                        <tr class="text-left border-b border-white/40">
                            <th>Tipo</th>
                            <th>Local</th>
                            <th>Data</th>
                            <th>Dose</th>
                        </tr>
                    </thead>

                    <ul id="lista_vacinas" class="mt-2"></ul>
                    
                    <form id="form_vacina" class="mt-6">
                        <input id="vacina_nome" type="text" placeholder="Nome da vacina" required>
                        <input id="vacina_data" type="date" required>
                        <button class="px-4 py-2 bg-teal-500 rounded-lg">Adicionar</button>
                    </form>

                    <!-- <span id="nomePerfil"></span>
                    <span id="emailPerfil"></span>
                    <span id="nascimentoPerfil"></span>
                    <span id="cpfPerfil"></span>
                    <span id="rgPerfil"></span>
                    <span id="cnsPerfil"></span> -->



                    <tbody class="opacity-80">
                        <tr class="h-10"><td></td><td></td><td></td><td></td></tr>
                        <tr class="h-10"><td></td><td></td><td></td><td></td></tr>
                        <tr class="h-10"><td></td><td></td><td></td><td></td></tr>
                        <tr class="h-10"><td></td><td></td><td></td><td></td></tr>
                    </tbody>
                </table>
            </div>

        </div>

        <!-- Avisos -->
        <div class="grid grid-cols-2 gap-6 mt-10">

            <div class="glass p-6 rounded-2xl flex items-center space-x-4">
                <img src="https://cdn-icons-png.flaticon.com/512/833/833524.png" class="w-10 opacity-90" />
                <p>Faltam apenas <strong>2 doses</strong> para liberar recompensas!</p>
            </div>

            <div class="glass p-6 rounded-2xl flex items-center space-x-4">
                <img src="https://cdn-icons-png.flaticon.com/512/1827/1827344.png" class="w-10 opacity-90" />
                <p>Lembrete adicionado com sucesso! <a href="#" class="underline text-blue-200">ver</a></p>
            </div>

        </div>

    </main>
    <script type="module">
        import { obterUsuario, adicionarVacina } from "./api.js";
    
        const usuario = obterUsuario();
    
        // --- CARREGAR DADOS DO USUÁRIO NO PERFIL --- //
        document.getElementById("perfil_nome").textContent = usuario.nome;
        document.getElementById("perfil_email").textContent = usuario.email;
        document.getElementById("perfil_nascimento").textContent = usuario.nascimento;
        document.getElementById("perfil_cpf").textContent = usuario.cpf;
        document.getElementById("perfil_rg").textContent = usuario.rg;
        document.getElementById("perfil_cns").textContent = usuario.cns;
    
        // --- LISTAR VACINAS --- //
        function atualizarListaVacinas() {
            const lista = document.getElementById("lista_vacinas");
            lista.innerHTML = "";
    
            if (usuario.vacinas && usuario.vacinas.length > 0) {
                usuario.vacinas.forEach(v => {
                    const li = document.createElement("li");
                    li.textContent = `${v.nome} - ${v.data}`;
                    lista.appendChild(li);
                });
            } else {
                lista.innerHTML = "<p>Nenhuma vacina registrada.</p>";
            }
        }
    
        atualizarListaVacinas();
    
        // --- ADICIONAR VACINA --- //
        document.getElementById("form_vacina").addEventListener("submit", (e) => {
            e.preventDefault();
    
            const vacina = {
                nome: document.getElementById("vacina_nome").value,
                data: document.getElementById("vacina_data").value
            };
    
            adicionarVacina(vacina);   
    
            atualizarListaVacinas();
            e.target.reset();
        });
    </script>
    
</body>
</html>
